<!-- 
DESCRIPTION ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

-->
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>exp</title>
  <script src="jspsych-6.0.3/jspsych.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-fullscreen.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-html-keyboard-response.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-html-button-response.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-survey-text.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-survey-likert.js"></script>
  <script src="jspsych-6.0.3/plugins/jspsych-survey-multi-choice.js"></script>
  <script src="js/jspsych-html-slider-response_required.js"></script>
  <script src="js/jquery.min.js"></script>
  <script src="js/lodash.min.js"></script>
  <script src="js/firebase.js"></script>
  <link href="jspsych-6.0.3/css/jspsych.css" rel="stylesheet" type="text/css">
  <style>
  body {
    cursor: default;
  }
  #jspsych-html-slider-response-next {
    margin: 0px;
  }
  .imgJudge {
    width: 300px;
    margin: 0px;
    padding: 0px;
  }
  .jspsych-content-wrapper {
    width: 800px;
    height: 600px;
  }
</style>
</head>
<body></body>
<script>
  /* Parameters */
  var n = 2; // number of CIs randomly sample for each cell
  var githubCIs = 'https://raw.githubusercontent.com/marinerougier/cis_gene_Expe3/master/'; // github CIs path

  /* Initial variables */
  var timeline = [];
  var preloadimages = [];
  var prolificID = jsPsych.data.getURLVariable("prolificID"); // Need to add ?prolificID={{%PROLIFIC_PID%}} at the end of the prolific survey link!

  /* Functions */
  function flatten(arr) {
    return arr.reduce(function (flat, toFlatten) {
      return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);
    }, []);
  };

  // CIs
  var imgLink = ["ci_1_app_AAT.jpeg",
"ci_2_app_AAT.jpeg",
"ci_3_app_AAT.jpeg",
"ci_4_app_AAT.jpeg",
"ci_5_app_AAT.jpeg",
"ci_6_app_AAT.jpeg",
"ci_7_app_AAT.jpeg",
"ci_8_app_AAT.jpeg",
"ci_9_app_AAT.jpeg",
"ci_10_app_AAT.jpeg",
"ci_11_app_AAT.jpeg",
"ci_12_app_AAT.jpeg",
"ci_13_app_AAT.jpeg",
"ci_14_app_AAT.jpeg",
"ci_15_app_AAT.jpeg",
"ci_16_app_AAT.jpeg",
"ci_17_app_AAT.jpeg",
"ci_18_app_AAT.jpeg",
"ci_19_app_AAT.jpeg",
"ci_20_app_AAT.jpeg",
"ci_21_app_AAT.jpeg",
"ci_22_app_AAT.jpeg",
"ci_23_app_AAT.jpeg",
"ci_24_app_AAT.jpeg",
"ci_25_app_AAT.jpeg",
"ci_26_app_AAT.jpeg",
"ci_27_app_AAT.jpeg",
"ci_28_app_AAT.jpeg",
"ci_29_app_AAT.jpeg",
"ci_30_app_AAT.jpeg",
"ci_31_app_AAT.jpeg",
"ci_32_app_AAT.jpeg",
"ci_33_app_AAT.jpeg",
"ci_34_app_AAT.jpeg",
"ci_35_app_AAT.jpeg",
"ci_36_app_AAT.jpeg",
"ci_37_app_AAT.jpeg",
"ci_38_app_AAT.jpeg",
"ci_39_app_AAT.jpeg",
"ci_40_app_AAT.jpeg",
"ci_41_app_AAT.jpeg",
"ci_42_app_AAT.jpeg",
"ci_43_app_AAT.jpeg",
"ci_44_app_AAT.jpeg",
"ci_45_app_AAT.jpeg",
"ci_46_app_AAT.jpeg",
"ci_47_app_AAT.jpeg",
"ci_48_app_AAT.jpeg",
"ci_49_app_AAT.jpeg",
"ci_50_app_AAT.jpeg",
"ci_51_app_AAT.jpeg",
"ci_52_app_AAT.jpeg",
"ci_53_app_AAT.jpeg",
"ci_54_app_AAT.jpeg",
"ci_55_app_AAT.jpeg",
"ci_56_app_AAT.jpeg",
"ci_57_app_AAT.jpeg",
"ci_58_app_AAT.jpeg",
"ci_59_app_AAT.jpeg",
"ci_60_app_AAT.jpeg",
"ci_61_app_AAT.jpeg",
"ci_62_app_AAT.jpeg",
"ci_63_app_AAT.jpeg",
"ci_64_app_AAT.jpeg",
"ci_65_app_AAT.jpeg",
"ci_66_app_AAT.jpeg",
"ci_67_app_AAT.jpeg",
"ci_68_app_AAT.jpeg",
"ci_69_app_AAT.jpeg",
"ci_70_app_AAT.jpeg",
"ci_71_app_AAT.jpeg",
"ci_72_app_AAT.jpeg",
"ci_73_app_AAT.jpeg",
"ci_74_app_AAT.jpeg",
"ci_75_app_AAT.jpeg",
"ci_76_app_AAT.jpeg",
"ci_77_app_AAT.jpeg",
"ci_78_app_AAT.jpeg",
"ci_79_app_AAT.jpeg",
"ci_80_app_AAT.jpeg",
"ci_81_app_AAT.jpeg",
"ci_82_app_AAT.jpeg",
"ci_83_app_AAT.jpeg",
"ci_84_app_AAT.jpeg",
"ci_85_app_AAT.jpeg",
"ci_86_app_AAT.jpeg",
"ci_87_app_AAT.jpeg",
"ci_88_app_AAT.jpeg",
"ci_89_app_AAT.jpeg",
"ci_90_app_AAT.jpeg",
"ci_91_app_AAT.jpeg",
"ci_92_app_AAT.jpeg",
"ci_93_app_AAT.jpeg",
"ci_94_app_AAT.jpeg",
"ci_95_app_AAT.jpeg",
"ci_96_app_AAT.jpeg",
"ci_97_app_AAT.jpeg",
"ci_98_app_AAT.jpeg",
"ci_99_app_AAT.jpeg",
"ci_100_app_AAT.jpeg",
"ci_101_app_AAT.jpeg",
"ci_102_app_AAT.jpeg",
"ci_103_app_AAT.jpeg",
"ci_104_app_AAT.jpeg",
"ci_105_app_AAT.jpeg",
"ci_106_app_AAT.jpeg",
"ci_107_app_AAT.jpeg",
"ci_108_app_AAT.jpeg",
"ci_109_app_AAT.jpeg",
"ci_110_app_AAT.jpeg",
"ci_111_app_AAT.jpeg",
"ci_112_app_AAT.jpeg",
"ci_113_app_AAT.jpeg",
"ci_114_app_AAT.jpeg",
"ci_115_app_AAT.jpeg",
"ci_116_app_AAT.jpeg",
"ci_117_app_AAT.jpeg",
"ci_118_app_AAT.jpeg",
"ci_119_app_AAT.jpeg",
"ci_120_app_AAT.jpeg",
"ci_121_app_AAT.jpeg",
"ci_122_app_AAT.jpeg",
"ci_123_app_AAT.jpeg",
"ci_124_app_AAT.jpeg",
"ci_125_app_AAT.jpeg",
"ci_126_app_AAT.jpeg",
"ci_127_app_AAT.jpeg",
"ci_128_app_AAT.jpeg",
"ci_129_app_AAT.jpeg",
"ci_130_app_AAT.jpeg",
"ci_131_app_AAT.jpeg",
"ci_132_app_AAT.jpeg",
"ci_133_app_AAT.jpeg",
"ci_134_app_AAT.jpeg",
"ci_135_app_AAT.jpeg",
"ci_136_app_AAT.jpeg",
"ci_137_app_AAT.jpeg",
"ci_138_app_AAT.jpeg",
"ci_139_app_AAT.jpeg",
"ci_140_app_AAT.jpeg",
"ci_141_app_AAT.jpeg",
"ci_142_app_AAT.jpeg",
"ci_143_app_AAT.jpeg",
"ci_144_app_AAT.jpeg",
"ci_145_app_AAT.jpeg",
"ci_146_app_AAT.jpeg",
"ci_147_app_AAT.jpeg",
"ci_148_app_AAT.jpeg",
"ci_149_app_AAT.jpeg",
"ci_150_app_AAT.jpeg",
"ci_151_app_AAT.jpeg",
"ci_152_app_AAT.jpeg",
"ci_153_app_AAT.jpeg",
"ci_154_app_AAT.jpeg",
"ci_155_app_AAT.jpeg",
"ci_156_app_AAT.jpeg",
"ci_157_app_AAT.jpeg",
"ci_158_app_AAT.jpeg",
"ci_159_app_AAT.jpeg",
"ci_160_app_AAT.jpeg",
"ci_161_app_AAT.jpeg",
"ci_162_app_AAT.jpeg",
"ci_163_app_AAT.jpeg",
"ci_164_app_AAT.jpeg",
"ci_165_app_AAT.jpeg",
"ci_166_app_AAT.jpeg",
"ci_167_app_AAT.jpeg",
"ci_168_app_AAT.jpeg",
"ci_169_app_AAT.jpeg",
"ci_170_app_AAT.jpeg",
"ci_171_app_AAT.jpeg",
"ci_172_app_AAT.jpeg",
"ci_173_app_AAT.jpeg",
"ci_174_app_AAT.jpeg",
"ci_175_app_AAT.jpeg",
"ci_176_app_AAT.jpeg",
"ci_177_app_AAT.jpeg",
"ci_178_app_AAT.jpeg",
"ci_179_app_AAT.jpeg",
"ci_180_app_AAT.jpeg",
"ci_181_app_AAT.jpeg",
"ci_182_app_AAT.jpeg",
"ci_183_app_AAT.jpeg",
"ci_184_app_AAT.jpeg",
"ci_185_app_AAT.jpeg",
"ci_186_app_AAT.jpeg",
"ci_187_app_AAT.jpeg",
"ci_188_app_AAT.jpeg",
"ci_189_app_AAT.jpeg",
"ci_190_app_AAT.jpeg",
"ci_191_app_AAT.jpeg",
"ci_192_app_AAT.jpeg",
"ci_193_app_AAT.jpeg",
"ci_194_app_AAT.jpeg",
"ci_195_app_AAT.jpeg",
"ci_196_app_AAT.jpeg",
"ci_197_app_AAT.jpeg",
"ci_198_app_AAT.jpeg",
"ci_199_app_AAT.jpeg",
"ci_200_app_AAT.jpeg",
"ci_1_av_AAT.jpeg",
"ci_2_av_AAT.jpeg",
"ci_3_av_AAT.jpeg",
"ci_4_av_AAT.jpeg",
"ci_5_av_AAT.jpeg",
"ci_6_av_AAT.jpeg",
"ci_7_av_AAT.jpeg",
"ci_8_av_AAT.jpeg",
"ci_9_av_AAT.jpeg",
"ci_10_av_AAT.jpeg",
"ci_11_av_AAT.jpeg",
"ci_12_av_AAT.jpeg",
"ci_13_av_AAT.jpeg",
"ci_14_av_AAT.jpeg",
"ci_15_av_AAT.jpeg",
"ci_16_av_AAT.jpeg",
"ci_17_av_AAT.jpeg",
"ci_18_av_AAT.jpeg",
"ci_19_av_AAT.jpeg",
"ci_20_av_AAT.jpeg",
"ci_21_av_AAT.jpeg",
"ci_22_av_AAT.jpeg",
"ci_23_av_AAT.jpeg",
"ci_24_av_AAT.jpeg",
"ci_25_av_AAT.jpeg",
"ci_26_av_AAT.jpeg",
"ci_27_av_AAT.jpeg",
"ci_28_av_AAT.jpeg",
"ci_29_av_AAT.jpeg",
"ci_30_av_AAT.jpeg",
"ci_31_av_AAT.jpeg",
"ci_32_av_AAT.jpeg",
"ci_33_av_AAT.jpeg",
"ci_34_av_AAT.jpeg",
"ci_35_av_AAT.jpeg",
"ci_36_av_AAT.jpeg",
"ci_37_av_AAT.jpeg",
"ci_38_av_AAT.jpeg",
"ci_39_av_AAT.jpeg",
"ci_40_av_AAT.jpeg",
"ci_41_av_AAT.jpeg",
"ci_42_av_AAT.jpeg",
"ci_43_av_AAT.jpeg",
"ci_44_av_AAT.jpeg",
"ci_45_av_AAT.jpeg",
"ci_46_av_AAT.jpeg",
"ci_47_av_AAT.jpeg",
"ci_48_av_AAT.jpeg",
"ci_49_av_AAT.jpeg",
"ci_50_av_AAT.jpeg",
"ci_51_av_AAT.jpeg",
"ci_52_av_AAT.jpeg",
"ci_53_av_AAT.jpeg",
"ci_54_av_AAT.jpeg",
"ci_55_av_AAT.jpeg",
"ci_56_av_AAT.jpeg",
"ci_57_av_AAT.jpeg",
"ci_58_av_AAT.jpeg",
"ci_59_av_AAT.jpeg",
"ci_60_av_AAT.jpeg",
"ci_61_av_AAT.jpeg",
"ci_62_av_AAT.jpeg",
"ci_63_av_AAT.jpeg",
"ci_64_av_AAT.jpeg",
"ci_65_av_AAT.jpeg",
"ci_66_av_AAT.jpeg",
"ci_67_av_AAT.jpeg",
"ci_68_av_AAT.jpeg",
"ci_69_av_AAT.jpeg",
"ci_70_av_AAT.jpeg",
"ci_71_av_AAT.jpeg",
"ci_72_av_AAT.jpeg",
"ci_73_av_AAT.jpeg",
"ci_74_av_AAT.jpeg",
"ci_75_av_AAT.jpeg",
"ci_76_av_AAT.jpeg",
"ci_77_av_AAT.jpeg",
"ci_78_av_AAT.jpeg",
"ci_79_av_AAT.jpeg",
"ci_80_av_AAT.jpeg",
"ci_81_av_AAT.jpeg",
"ci_82_av_AAT.jpeg",
"ci_83_av_AAT.jpeg",
"ci_84_av_AAT.jpeg",
"ci_85_av_AAT.jpeg",
"ci_86_av_AAT.jpeg",
"ci_87_av_AAT.jpeg",
"ci_88_av_AAT.jpeg",
"ci_89_av_AAT.jpeg",
"ci_90_av_AAT.jpeg",
"ci_91_av_AAT.jpeg",
"ci_92_av_AAT.jpeg",
"ci_93_av_AAT.jpeg",
"ci_94_av_AAT.jpeg",
"ci_95_av_AAT.jpeg",
"ci_96_av_AAT.jpeg",
"ci_97_av_AAT.jpeg",
"ci_98_av_AAT.jpeg",
"ci_99_av_AAT.jpeg",
"ci_100_av_AAT.jpeg",
"ci_101_av_AAT.jpeg",
"ci_102_av_AAT.jpeg",
"ci_103_av_AAT.jpeg",
"ci_104_av_AAT.jpeg",
"ci_105_av_AAT.jpeg",
"ci_106_av_AAT.jpeg",
"ci_107_av_AAT.jpeg",
"ci_108_av_AAT.jpeg",
"ci_109_av_AAT.jpeg",
"ci_110_av_AAT.jpeg",
"ci_111_av_AAT.jpeg",
"ci_112_av_AAT.jpeg",
"ci_113_av_AAT.jpeg",
"ci_114_av_AAT.jpeg",
"ci_115_av_AAT.jpeg",
"ci_116_av_AAT.jpeg",
"ci_117_av_AAT.jpeg",
"ci_118_av_AAT.jpeg",
"ci_119_av_AAT.jpeg",
"ci_120_av_AAT.jpeg",
"ci_121_av_AAT.jpeg",
"ci_122_av_AAT.jpeg",
"ci_123_av_AAT.jpeg",
"ci_124_av_AAT.jpeg",
"ci_125_av_AAT.jpeg",
"ci_126_av_AAT.jpeg",
"ci_127_av_AAT.jpeg",
"ci_128_av_AAT.jpeg",
"ci_129_av_AAT.jpeg",
"ci_130_av_AAT.jpeg",
"ci_131_av_AAT.jpeg",
"ci_132_av_AAT.jpeg",
"ci_133_av_AAT.jpeg",
"ci_134_av_AAT.jpeg",
"ci_135_av_AAT.jpeg",
"ci_136_av_AAT.jpeg",
"ci_137_av_AAT.jpeg",
"ci_138_av_AAT.jpeg",
"ci_139_av_AAT.jpeg",
"ci_140_av_AAT.jpeg",
"ci_141_av_AAT.jpeg",
"ci_142_av_AAT.jpeg",
"ci_143_av_AAT.jpeg",
"ci_144_av_AAT.jpeg",
"ci_145_av_AAT.jpeg",
"ci_146_av_AAT.jpeg",
"ci_147_av_AAT.jpeg",
"ci_148_av_AAT.jpeg",
"ci_149_av_AAT.jpeg",
"ci_150_av_AAT.jpeg",
"ci_151_av_AAT.jpeg",
"ci_152_av_AAT.jpeg",
"ci_153_av_AAT.jpeg",
"ci_154_av_AAT.jpeg",
"ci_155_av_AAT.jpeg",
"ci_156_av_AAT.jpeg",
"ci_157_av_AAT.jpeg",
"ci_158_av_AAT.jpeg",
"ci_159_av_AAT.jpeg",
"ci_160_av_AAT.jpeg",
"ci_161_av_AAT.jpeg",
"ci_162_av_AAT.jpeg",
"ci_163_av_AAT.jpeg",
"ci_164_av_AAT.jpeg",
"ci_165_av_AAT.jpeg",
"ci_166_av_AAT.jpeg",
"ci_167_av_AAT.jpeg",
"ci_168_av_AAT.jpeg",
"ci_169_av_AAT.jpeg",
"ci_170_av_AAT.jpeg",
"ci_171_av_AAT.jpeg",
"ci_172_av_AAT.jpeg",
"ci_173_av_AAT.jpeg",
"ci_174_av_AAT.jpeg",
"ci_175_av_AAT.jpeg",
"ci_176_av_AAT.jpeg",
"ci_177_av_AAT.jpeg",
"ci_178_av_AAT.jpeg",
"ci_179_av_AAT.jpeg",
"ci_180_av_AAT.jpeg",
"ci_181_av_AAT.jpeg",
"ci_182_av_AAT.jpeg",
"ci_183_av_AAT.jpeg",
"ci_184_av_AAT.jpeg",
"ci_185_av_AAT.jpeg",
"ci_186_av_AAT.jpeg",
"ci_187_av_AAT.jpeg",
"ci_188_av_AAT.jpeg",
"ci_189_av_AAT.jpeg",
"ci_190_av_AAT.jpeg",
"ci_191_av_AAT.jpeg",
"ci_192_av_AAT.jpeg",
"ci_193_av_AAT.jpeg",
"ci_194_av_AAT.jpeg",
"ci_195_av_AAT.jpeg",
"ci_196_av_AAT.jpeg",
"ci_197_av_AAT.jpeg",
"ci_198_av_AAT.jpeg",
"ci_199_av_AAT.jpeg",
"ci_200_av_AAT.jpeg",
"ci_201_app_Instr.jpeg",
"ci_202_app_Instr.jpeg",
"ci_203_app_Instr.jpeg",
"ci_204_app_Instr.jpeg",
"ci_205_app_Instr.jpeg",
"ci_206_app_Instr.jpeg",
"ci_207_app_Instr.jpeg",
"ci_208_app_Instr.jpeg",
"ci_209_app_Instr.jpeg",
"ci_210_app_Instr.jpeg",
"ci_211_app_Instr.jpeg",
"ci_212_app_Instr.jpeg",
"ci_213_app_Instr.jpeg",
"ci_214_app_Instr.jpeg",
"ci_215_app_Instr.jpeg",
"ci_216_app_Instr.jpeg",
"ci_217_app_Instr.jpeg",
"ci_218_app_Instr.jpeg",
"ci_219_app_Instr.jpeg",
"ci_220_app_Instr.jpeg",
"ci_221_app_Instr.jpeg",
"ci_222_app_Instr.jpeg",
"ci_223_app_Instr.jpeg",
"ci_224_app_Instr.jpeg",
"ci_225_app_Instr.jpeg",
"ci_226_app_Instr.jpeg",
"ci_227_app_Instr.jpeg",
"ci_228_app_Instr.jpeg",
"ci_229_app_Instr.jpeg",
"ci_230_app_Instr.jpeg",
"ci_231_app_Instr.jpeg",
"ci_232_app_Instr.jpeg",
"ci_233_app_Instr.jpeg",
"ci_234_app_Instr.jpeg",
"ci_235_app_Instr.jpeg",
"ci_236_app_Instr.jpeg",
"ci_237_app_Instr.jpeg",
"ci_238_app_Instr.jpeg",
"ci_239_app_Instr.jpeg",
"ci_240_app_Instr.jpeg",
"ci_241_app_Instr.jpeg",
"ci_242_app_Instr.jpeg",
"ci_243_app_Instr.jpeg",
"ci_244_app_Instr.jpeg",
"ci_245_app_Instr.jpeg",
"ci_246_app_Instr.jpeg",
"ci_247_app_Instr.jpeg",
"ci_248_app_Instr.jpeg",
"ci_249_app_Instr.jpeg",
"ci_250_app_Instr.jpeg",
"ci_251_app_Instr.jpeg",
"ci_252_app_Instr.jpeg",
"ci_253_app_Instr.jpeg",
"ci_254_app_Instr.jpeg",
"ci_255_app_Instr.jpeg",
"ci_256_app_Instr.jpeg",
"ci_257_app_Instr.jpeg",
"ci_258_app_Instr.jpeg",
"ci_259_app_Instr.jpeg",
"ci_260_app_Instr.jpeg",
"ci_261_app_Instr.jpeg",
"ci_262_app_Instr.jpeg",
"ci_263_app_Instr.jpeg",
"ci_264_app_Instr.jpeg",
"ci_265_app_Instr.jpeg",
"ci_266_app_Instr.jpeg",
"ci_267_app_Instr.jpeg",
"ci_268_app_Instr.jpeg",
"ci_269_app_Instr.jpeg",
"ci_270_app_Instr.jpeg",
"ci_271_app_Instr.jpeg",
"ci_272_app_Instr.jpeg",
"ci_273_app_Instr.jpeg",
"ci_274_app_Instr.jpeg",
"ci_275_app_Instr.jpeg",
"ci_276_app_Instr.jpeg",
"ci_277_app_Instr.jpeg",
"ci_278_app_Instr.jpeg",
"ci_279_app_Instr.jpeg",
"ci_280_app_Instr.jpeg",
"ci_281_app_Instr.jpeg",
"ci_282_app_Instr.jpeg",
"ci_283_app_Instr.jpeg",
"ci_284_app_Instr.jpeg",
"ci_285_app_Instr.jpeg",
"ci_286_app_Instr.jpeg",
"ci_287_app_Instr.jpeg",
"ci_288_app_Instr.jpeg",
"ci_289_app_Instr.jpeg",
"ci_290_app_Instr.jpeg",
"ci_291_app_Instr.jpeg",
"ci_292_app_Instr.jpeg",
"ci_293_app_Instr.jpeg",
"ci_294_app_Instr.jpeg",
"ci_295_app_Instr.jpeg",
"ci_296_app_Instr.jpeg",
"ci_297_app_Instr.jpeg",
"ci_298_app_Instr.jpeg",
"ci_299_app_Instr.jpeg",
"ci_300_app_Instr.jpeg",
"ci_301_app_Instr.jpeg",
"ci_302_app_Instr.jpeg",
"ci_303_app_Instr.jpeg",
"ci_304_app_Instr.jpeg",
"ci_305_app_Instr.jpeg",
"ci_306_app_Instr.jpeg",
"ci_307_app_Instr.jpeg",
"ci_308_app_Instr.jpeg",
"ci_309_app_Instr.jpeg",
"ci_310_app_Instr.jpeg",
"ci_311_app_Instr.jpeg",
"ci_312_app_Instr.jpeg",
"ci_313_app_Instr.jpeg",
"ci_314_app_Instr.jpeg",
"ci_315_app_Instr.jpeg",
"ci_316_app_Instr.jpeg",
"ci_317_app_Instr.jpeg",
"ci_318_app_Instr.jpeg",
"ci_319_app_Instr.jpeg",
"ci_320_app_Instr.jpeg",
"ci_321_app_Instr.jpeg",
"ci_322_app_Instr.jpeg",
"ci_323_app_Instr.jpeg",
"ci_324_app_Instr.jpeg",
"ci_325_app_Instr.jpeg",
"ci_326_app_Instr.jpeg",
"ci_327_app_Instr.jpeg",
"ci_328_app_Instr.jpeg",
"ci_329_app_Instr.jpeg",
"ci_330_app_Instr.jpeg",
"ci_331_app_Instr.jpeg",
"ci_332_app_Instr.jpeg",
"ci_333_app_Instr.jpeg",
"ci_334_app_Instr.jpeg",
"ci_335_app_Instr.jpeg",
"ci_336_app_Instr.jpeg",
"ci_337_app_Instr.jpeg",
"ci_338_app_Instr.jpeg",
"ci_339_app_Instr.jpeg",
"ci_340_app_Instr.jpeg",
"ci_341_app_Instr.jpeg",
"ci_342_app_Instr.jpeg",
"ci_343_app_Instr.jpeg",
"ci_344_app_Instr.jpeg",
"ci_345_app_Instr.jpeg",
"ci_346_app_Instr.jpeg",
"ci_347_app_Instr.jpeg",
"ci_348_app_Instr.jpeg",
"ci_349_app_Instr.jpeg",
"ci_350_app_Instr.jpeg",
"ci_351_app_Instr.jpeg",
"ci_352_app_Instr.jpeg",
"ci_353_app_Instr.jpeg",
"ci_354_app_Instr.jpeg",
"ci_355_app_Instr.jpeg",
"ci_356_app_Instr.jpeg",
"ci_357_app_Instr.jpeg",
"ci_358_app_Instr.jpeg",
"ci_359_app_Instr.jpeg",
"ci_360_app_Instr.jpeg",
"ci_361_app_Instr.jpeg",
"ci_362_app_Instr.jpeg",
"ci_363_app_Instr.jpeg",
"ci_364_app_Instr.jpeg",
"ci_365_app_Instr.jpeg",
"ci_366_app_Instr.jpeg",
"ci_367_app_Instr.jpeg",
"ci_368_app_Instr.jpeg",
"ci_369_app_Instr.jpeg",
"ci_370_app_Instr.jpeg",
"ci_371_app_Instr.jpeg",
"ci_372_app_Instr.jpeg",
"ci_373_app_Instr.jpeg",
"ci_374_app_Instr.jpeg",
"ci_375_app_Instr.jpeg",
"ci_376_app_Instr.jpeg",
"ci_377_app_Instr.jpeg",
"ci_378_app_Instr.jpeg",
"ci_379_app_Instr.jpeg",
"ci_380_app_Instr.jpeg",
"ci_381_app_Instr.jpeg",
"ci_382_app_Instr.jpeg",
"ci_383_app_Instr.jpeg",
"ci_384_app_Instr.jpeg",
"ci_385_app_Instr.jpeg",
"ci_386_app_Instr.jpeg",
"ci_387_app_Instr.jpeg",
"ci_388_app_Instr.jpeg",
"ci_389_app_Instr.jpeg",
"ci_390_app_Instr.jpeg",
"ci_391_app_Instr.jpeg",
"ci_392_app_Instr.jpeg",
"ci_393_app_Instr.jpeg",
"ci_394_app_Instr.jpeg",
"ci_395_app_Instr.jpeg",
"ci_396_app_Instr.jpeg",
"ci_397_app_Instr.jpeg",
"ci_398_app_Instr.jpeg",
"ci_399_app_Instr.jpeg",
"ci_400_app_Instr.jpeg",
"ci_201_av_Instr.jpeg",
"ci_202_av_Instr.jpeg",
"ci_203_av_Instr.jpeg",
"ci_204_av_Instr.jpeg",
"ci_205_av_Instr.jpeg",
"ci_206_av_Instr.jpeg",
"ci_207_av_Instr.jpeg",
"ci_208_av_Instr.jpeg",
"ci_209_av_Instr.jpeg",
"ci_210_av_Instr.jpeg",
"ci_211_av_Instr.jpeg",
"ci_212_av_Instr.jpeg",
"ci_213_av_Instr.jpeg",
"ci_214_av_Instr.jpeg",
"ci_215_av_Instr.jpeg",
"ci_216_av_Instr.jpeg",
"ci_217_av_Instr.jpeg",
"ci_218_av_Instr.jpeg",
"ci_219_av_Instr.jpeg",
"ci_220_av_Instr.jpeg",
"ci_221_av_Instr.jpeg",
"ci_222_av_Instr.jpeg",
"ci_223_av_Instr.jpeg",
"ci_224_av_Instr.jpeg",
"ci_225_av_Instr.jpeg",
"ci_226_av_Instr.jpeg",
"ci_227_av_Instr.jpeg",
"ci_228_av_Instr.jpeg",
"ci_229_av_Instr.jpeg",
"ci_230_av_Instr.jpeg",
"ci_231_av_Instr.jpeg",
"ci_232_av_Instr.jpeg",
"ci_233_av_Instr.jpeg",
"ci_234_av_Instr.jpeg",
"ci_235_av_Instr.jpeg",
"ci_236_av_Instr.jpeg",
"ci_237_av_Instr.jpeg",
"ci_238_av_Instr.jpeg",
"ci_239_av_Instr.jpeg",
"ci_240_av_Instr.jpeg",
"ci_241_av_Instr.jpeg",
"ci_242_av_Instr.jpeg",
"ci_243_av_Instr.jpeg",
"ci_244_av_Instr.jpeg",
"ci_245_av_Instr.jpeg",
"ci_246_av_Instr.jpeg",
"ci_247_av_Instr.jpeg",
"ci_248_av_Instr.jpeg",
"ci_249_av_Instr.jpeg",
"ci_250_av_Instr.jpeg",
"ci_251_av_Instr.jpeg",
"ci_252_av_Instr.jpeg",
"ci_253_av_Instr.jpeg",
"ci_254_av_Instr.jpeg",
"ci_255_av_Instr.jpeg",
"ci_256_av_Instr.jpeg",
"ci_257_av_Instr.jpeg",
"ci_258_av_Instr.jpeg",
"ci_259_av_Instr.jpeg",
"ci_260_av_Instr.jpeg",
"ci_261_av_Instr.jpeg",
"ci_262_av_Instr.jpeg",
"ci_263_av_Instr.jpeg",
"ci_264_av_Instr.jpeg",
"ci_265_av_Instr.jpeg",
"ci_266_av_Instr.jpeg",
"ci_267_av_Instr.jpeg",
"ci_268_av_Instr.jpeg",
"ci_269_av_Instr.jpeg",
"ci_270_av_Instr.jpeg",
"ci_271_av_Instr.jpeg",
"ci_272_av_Instr.jpeg",
"ci_273_av_Instr.jpeg",
"ci_274_av_Instr.jpeg",
"ci_275_av_Instr.jpeg",
"ci_276_av_Instr.jpeg",
"ci_277_av_Instr.jpeg",
"ci_278_av_Instr.jpeg",
"ci_279_av_Instr.jpeg",
"ci_280_av_Instr.jpeg",
"ci_281_av_Instr.jpeg",
"ci_282_av_Instr.jpeg",
"ci_283_av_Instr.jpeg",
"ci_284_av_Instr.jpeg",
"ci_285_av_Instr.jpeg",
"ci_286_av_Instr.jpeg",
"ci_287_av_Instr.jpeg",
"ci_288_av_Instr.jpeg",
"ci_289_av_Instr.jpeg",
"ci_290_av_Instr.jpeg",
"ci_291_av_Instr.jpeg",
"ci_292_av_Instr.jpeg",
"ci_293_av_Instr.jpeg",
"ci_294_av_Instr.jpeg",
"ci_295_av_Instr.jpeg",
"ci_296_av_Instr.jpeg",
"ci_297_av_Instr.jpeg",
"ci_298_av_Instr.jpeg",
"ci_299_av_Instr.jpeg",
"ci_300_av_Instr.jpeg",
"ci_301_av_Instr.jpeg",
"ci_302_av_Instr.jpeg",
"ci_303_av_Instr.jpeg",
"ci_304_av_Instr.jpeg",
"ci_305_av_Instr.jpeg",
"ci_306_av_Instr.jpeg",
"ci_307_av_Instr.jpeg",
"ci_308_av_Instr.jpeg",
"ci_309_av_Instr.jpeg",
"ci_310_av_Instr.jpeg",
"ci_311_av_Instr.jpeg",
"ci_312_av_Instr.jpeg",
"ci_313_av_Instr.jpeg",
"ci_314_av_Instr.jpeg",
"ci_315_av_Instr.jpeg",
"ci_316_av_Instr.jpeg",
"ci_317_av_Instr.jpeg",
"ci_318_av_Instr.jpeg",
"ci_319_av_Instr.jpeg",
"ci_320_av_Instr.jpeg",
"ci_321_av_Instr.jpeg",
"ci_322_av_Instr.jpeg",
"ci_323_av_Instr.jpeg",
"ci_324_av_Instr.jpeg",
"ci_325_av_Instr.jpeg",
"ci_326_av_Instr.jpeg",
"ci_327_av_Instr.jpeg",
"ci_328_av_Instr.jpeg",
"ci_329_av_Instr.jpeg",
"ci_330_av_Instr.jpeg",
"ci_331_av_Instr.jpeg",
"ci_332_av_Instr.jpeg",
"ci_333_av_Instr.jpeg",
"ci_334_av_Instr.jpeg",
"ci_335_av_Instr.jpeg",
"ci_336_av_Instr.jpeg",
"ci_337_av_Instr.jpeg",
"ci_338_av_Instr.jpeg",
"ci_339_av_Instr.jpeg",
"ci_340_av_Instr.jpeg",
"ci_341_av_Instr.jpeg",
"ci_342_av_Instr.jpeg",
"ci_343_av_Instr.jpeg",
"ci_344_av_Instr.jpeg",
"ci_345_av_Instr.jpeg",
"ci_346_av_Instr.jpeg",
"ci_347_av_Instr.jpeg",
"ci_348_av_Instr.jpeg",
"ci_349_av_Instr.jpeg",
"ci_350_av_Instr.jpeg",
"ci_351_av_Instr.jpeg",
"ci_352_av_Instr.jpeg",
"ci_353_av_Instr.jpeg",
"ci_354_av_Instr.jpeg",
"ci_355_av_Instr.jpeg",
"ci_356_av_Instr.jpeg",
"ci_357_av_Instr.jpeg",
"ci_358_av_Instr.jpeg",
"ci_359_av_Instr.jpeg",
"ci_360_av_Instr.jpeg",
"ci_361_av_Instr.jpeg",
"ci_362_av_Instr.jpeg",
"ci_363_av_Instr.jpeg",
"ci_364_av_Instr.jpeg",
"ci_365_av_Instr.jpeg",
"ci_366_av_Instr.jpeg",
"ci_367_av_Instr.jpeg",
"ci_368_av_Instr.jpeg",
"ci_369_av_Instr.jpeg",
"ci_370_av_Instr.jpeg",
"ci_371_av_Instr.jpeg",
"ci_372_av_Instr.jpeg",
"ci_373_av_Instr.jpeg",
"ci_374_av_Instr.jpeg",
"ci_375_av_Instr.jpeg",
"ci_376_av_Instr.jpeg",
"ci_377_av_Instr.jpeg",
"ci_378_av_Instr.jpeg",
"ci_379_av_Instr.jpeg",
"ci_380_av_Instr.jpeg",
"ci_381_av_Instr.jpeg",
"ci_382_av_Instr.jpeg",
"ci_383_av_Instr.jpeg",
"ci_384_av_Instr.jpeg",
"ci_385_av_Instr.jpeg",
"ci_386_av_Instr.jpeg",
"ci_387_av_Instr.jpeg",
"ci_388_av_Instr.jpeg",
"ci_389_av_Instr.jpeg",
"ci_390_av_Instr.jpeg",
"ci_391_av_Instr.jpeg",
"ci_392_av_Instr.jpeg",
"ci_393_av_Instr.jpeg",
"ci_394_av_Instr.jpeg",
"ci_395_av_Instr.jpeg",
"ci_396_av_Instr.jpeg",
"ci_397_av_Instr.jpeg",
"ci_398_av_Instr.jpeg",
"ci_399_av_Instr.jpeg",
"ci_400_av_Instr.jpeg"];

  // Add relative path to CIs
  imgLink = imgLink.map(function(e) {return githubCIs + e});

  // CIs stims
  CIsStims = imgLink.map(function(e) {return {imgHtml: "<img class='imgJudge' src='" + e + "'>"}});

  // Randomly sample n CIs
  var sampledCIsStims = _.sampleSize(CIsStims, n);

  // Preload images
  preloadimages.push(imgLink);
  preloadimages = flatten(preloadimages);


  // EXPERIMENT --------------------------------------------------------------------------------------------------------

  /* FULL SCREEN MODE */
  var activeFullscreen = {
    message: "",
    button_label: "Veuillez cliquer ici pour activer le mode plein écran",
    type: 'fullscreen',
    fullscreen_mode: true,
    delay_after: 200,
  };

  /* CONSENT */
  var consent = {
    type: 'html-button-response',
    stimulus: function() {
        html = "";
        html += "<h1>Consentement éclairé</h1>";
        html += "<p class='justify'>Dans cette étude, vous allez devoir évaluer des visages sur plusieurs traits. ";
        html += "La durée de cette étude est d'environ <strong>5 minutes</strong>. Durant cette période, ";
        html += "il est important que vous restiez pleinement <strong>concentré.e</strong>.</p>";
        html += "<p class='justify'>Votre participation est volontaire, n'implique aucun risque, et vos réponses seront ";
        html += "enregistrées de manière anonyme. Vous êtes libre de vous retirer de l'étude à tout moment. Après avoir ";
        html += "complété l'entièreté de l'étude, vous recevrez une <strong>compensation monétaire</strong> ";
        html += "tel que décrit dans l'annonce Foule Factory.</p>";
        html += "<p class='justify'>Cette étude est administrée par Marine Rougier, post-doctorante à l'UCLouvain (Belgique). ";
        html += "Si vous avez des questions ou commentaires, contactez-moi à l'adresse suivante : <strong>marine.rougier@uclouvain.be</strong></p>";
        return html;
    },
    choices: ["J'accepte de participer à cette étude"],
  };

  /* PREVIEW CIS INSTRUCTIONS */
  var previewCIinst = {
    type: "html-keyboard-response",
    post_trial_gap: 300,
    choices: [32],
    stimulus: function() {
      var html = "";
      html += "<h1>Evaluation des visages</h1>";
      html += "<p class='justify'>Dans cette étude, vous allez devoir évaluer <b>XXX visages</b> et indiquer, pour "
      html += "chacun d'entre eux, à quel point celui-ci vous paraît <b>aggressif, digne de confiance</b> et ";
      html += "<b>criminel</b> (de 0 = pas du tout à 100 = totalement) </br> ";
      html += "Comme vous allez le voir, les visages qui vous seront présentés ont été rendus ";
      html += "<b>flous</b> afin de rendre la tâche moins aisée. </br></br>";
      html += "Notez qu'il est <b>extrêmement important</b> que vous répondiez aussi honnêtement et ";
      html += "spontanément que possible. La première réponse qui vient à l'esprit est généralement la meilleure. </br></br>";
      html += "Avant la tâche d’évaluation, un échantillon de visages ";
      html += "va vous être présenté (chaque visage apparaitra durant une seconde). Ceci vous permettra de mieux ";
      html += "prendre en compte les similarités/différences entre les visages avant leur évaluation.</br>";
      html += "Les visages défileront automatiquement, veuillez être attentif.</br></br>";
      html += "<p></br>appuyez sur <span class='light-keys'><kbd>espace</kbd></span> pour commencer</p>";
      return html;
    },
  };

  /* PREVIEW CIS */
  var previewCI = {
    timeline_variables: CIsStims,
    choices: jsPsych.NO_KEYS,
    trial_duration: 800,
    post_trial_gap: 200,
    timeline: [{
      type: 'html-keyboard-response',
      stimulus: function() {return jsPsych.timelineVariable('imgHtml', true)},
    }]
  };

  /* JUDGMENTS INSTRUCTIONS */
  var jugmentInst = {
    type: "html-keyboard-response",
    post_trial_gap: 300,
    choices: [32],
    stimulus: function() {
      var html = "";
      html += "<h1>Evaluation des visages</h1>";
      html += "<p class='justify'>Nous allons maintenant vous demander d'indiquer, "
      html += "pour chaque visage (25 visages), à quel point celui-ci vous paraît <b>XXX</b> ";
      html += "sur une échelle allant de 0 (pas du tout XXX) à 100 (très XXX).</br></br>";
      html += "Notez qu'il est extrêmement important que vous répondiez de façon honnête et spontanée.</br></br>";
      html += "<p></br>appuyez sur <span class='light-keys'><kbd>espace</kbd></span> pour commencer</p>";
      return html;
    },
  };


  // Judgments

  var scaleAgressivity = ["0</br>Pas du tout agressif", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100</br>Totalement agressif"];
  var scaleTrustworthiness = ["0</br>Pas du tout digne de confiance", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100</br>Totalement digne de confiance"];
  var scaleCriminality = ["0</br>Pas du tout criminel", "10", "20", "30", "40", "50", "60", "70", "80", "90", "100</br>Totalement criminel"];

  var judgments = [];
  CIsStims.map(function(ciImg){
    var likert_trial = {
        type: 'survey-likert',
        preamble: ciImg.imgHtml,
        questions: [
          {prompt: "", labels: scaleAgressivity, required: true},
          {prompt: "", labels: scaleTrustworthiness, required: true},
          {prompt: "", labels: scaleCriminality, required: true},
        ],
        button_label: 'Continuer',
        on_load: function() {
          $(".jspsych-content").css("max-width", "100%");
          $(".jspsych-survey-likert-statement").css("margin", "0px");
          $(".jspsych-survey-likert-statement").css("padding", "0px");
          $(".jspsych-survey-likert-opts").css("padding", "0 0 10px");
          $("#jspsych-survey-likert-next").css("margin-top", "10px");
          $("#jspsych-survey-likert-form").css("width", "800px");
          $("li").css("width", "9%");
        //   $("li:first-of-type").css("width", "110px");
        //   $("li:last-of-type").css("width", "110px");
        },
        on_finish: function(data) {
          var parsed_response  = JSON.parse(data.responses);
          data.agressivity     = parsed_response.Q0 * 10;
          data.trustworthiness = parsed_response.Q1 * 10;
          data.criminality     = parsed_response.Q2 * 10;
          data.ci              = ciImg.imgHtml;
        },
    };
    judgments.push(likert_trial);
  });


  /* AGE */
  var age = {
      timeline: [{
        type: 'survey-text',
        questions: [{prompt: "Veuillez indiquer votre âge :", rows: 1, columns: 10}],
        button_label: "Continuer",
      }],
      loop_function: function(data){ 
        var age = data.values()[0].responses;
        var age = JSON.parse(age).Q0; 
        if(age == ""){
          alert("Veuillez indiquer votre âge !"); 
          return true; 
        }
      },
      on_finish: function(data) {
          jsPsych.data.addProperties({
              age: JSON.parse(data.responses)["Q0"],
          });
      },
  };

  var gender = {
      type: 'survey-multi-choice',
      questions: [{prompt: "Veuillez indiquer votre genre :", options: [' homme', ' femme', ' autre'], required: true}],
      button_label: "Continuer",
      on_finish: function(data) {
          jsPsych.data.addProperties({
              gender: JSON.parse(data.responses)["Q0"],
          });
      },
  };

  /* EXIT FULLSCREEN MODE */
  var exitFullscreen = {
    type: 'fullscreen',
    fullscreen_mode: false
  };

  /* DEBRIEF */
  var debrief = [];
  debrief += "<h1>Fin de l'expérience</h1>";
  debrief += "<p class='justify'>Merci pour votre participation ! Cette étude avait pour but d'étudier la perception générale ";
  debrief += "qu'ont les individus de visages inconnus et ambigus.</br></br> "
  debrief += "<b>Veuillez copier le code suivant sur Foule Factory pour valider votre participation :</b></p> ";
  debrief += "<h1>JYP63M</h1>";
  //debrief += "<a href='https://www.google.com/' target='_blank'>cliquer ici pour valider votre expérience</a>";

  // TIMELINE ----------------------------------------------------------------------------------------------------------
  timeline.push(activeFullscreen);
  timeline.push(consent);
  timeline.push(previewCIinst);
  timeline.push(previewCI);
  timeline.push(judgments);
  timeline.push(age);
  timeline.push(gender);
  timeline.push(exitFullscreen);
  
  timeline = flatten(timeline); // do not remove this!

  // INITIALISE EXP ----------------------------------------------------------------------------------------------------
  jsPsych.init({
    timeline: timeline,
    preload_images: preloadimages,
    max_load_time: 500*1000,
    exclusions: {
      min_width: 800,
      min_height: 600,
    },
    on_finish: function(data) { 
      $("#jspsych-content").html("<img src='https://i.gifer.com/4V0b.gif'>");

      /* Initialize Firebase */
      var config = {
        apiKey: "AIzaSyBwDr8n-RNCbBOk1lKIxw7AFgslXGcnQzM",
        databaseURL: "https://marineexpe.firebaseio.com/"
      };

      firebase.initializeApp(config);
      var database = firebase.database();
      id = jsPsych.randomization.randomID(15); // short ID

      /* jsPsych: add data to every trial */
      jsPsych.data.addProperties({
        prolificID: prolificID,
        id: id,
        //traitsOrder: traitsOrder,
        totalTime: jsPsych.totalTime()
      });

      var subdata = data.filter({trial_type: 'survey-likert'}).csv();
    //   jsPsych.data.displayData();

      /* Send data to Firebase and redirect to Qualtrics */
      database.ref("judgeMarine3/" + id + "/").update({subdata}).then(function() { 
        console.log("data sent!");
        $("#jspsych-content").html(debrief);
        //window.location = qlink; // redirect to qualtrics
      });
    }
  });
</script>

</html>
